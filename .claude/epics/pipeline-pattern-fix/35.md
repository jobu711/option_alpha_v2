---
name: Add AI settings to config and wire timeout through client factory
status: open
created: 2026-02-11T18:41:29Z
updated: 2026-02-11T18:41:29Z
github: https://github.com/jobu711/option_alpha_v2/issues/35
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Add AI settings to config and wire timeout through client factory

## Description
Add 4 new AI-related settings to the `Settings` class in `config.py` following the existing `fetch_*` pattern, then update the `get_client()` factory in `ai/clients.py` to pass the configurable timeout to client constructors instead of relying on hardcoded defaults.

## Acceptance Criteria
- [ ] `Settings` class has `ai_retry_delays: list[float]` with default `[2.0, 4.0, 8.0]`
- [ ] `Settings` class has `ai_request_timeout: int` with default `120`
- [ ] `Settings` class has `ai_debate_phase_timeout: int` with default `600`
- [ ] `Settings` class has `ai_debate_concurrency: int` with default `3`
- [ ] All new fields support `OPTION_ALPHA_` env var prefix via existing `model_config`
- [ ] `get_client()` accepts and passes `timeout=settings.ai_request_timeout` to `OllamaClient` / `ClaudeClient`
- [ ] Existing behavior unchanged when using defaults (120s timeout)

## Technical Details
**Files:**
- `src/option_alpha/config.py` — Add 4 fields to `Settings` class in the `# --- AI backend ---` section
- `src/option_alpha/ai/clients.py` — Update `get_client()` factory (line 336-361) to pass `config.ai_request_timeout` as `timeout` kwarg

**Implementation:**
```python
# config.py — add after existing AI backend settings
ai_retry_delays: list[float] = Field(default_factory=lambda: [2.0, 4.0, 8.0])
ai_request_timeout: int = 120
ai_debate_phase_timeout: int = 600
ai_debate_concurrency: int = 3
```

```python
# clients.py — update get_client()
return OllamaClient(model=config.ollama_model, timeout=config.ai_request_timeout)
return ClaudeClient(api_key=config.claude_api_key, timeout=config.ai_request_timeout)
```

## Dependencies
- [ ] None — this is the foundation task

## Effort Estimate
- Size: XS
- Hours: 0.25
- Parallel: false (other tasks depend on this)

## Definition of Done
- [ ] Code implemented
- [ ] Settings accessible via env vars and config.json
- [ ] `get_client()` passes configurable timeout
- [ ] Existing tests still pass
