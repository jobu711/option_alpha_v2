---
name: Improve bull/bear/risk agent prompts
status: open
created: 2026-02-12T11:13:23Z
updated: 2026-02-12T11:15:00Z
github: https://github.com/jobu711/option_alpha_v2/issues/53
depends_on: [52]
parallel: false
conflicts_with: [52]
---

# Task: Improve bull/bear/risk agent prompts

## Description
Update the three system prompts in `ai/agents.py` to produce specific, actionable analysis per FR5 requirements. Agents should reference specific data values, provide price targets, and quantify risk/reward.

## Acceptance Criteria
- [ ] Bull prompt instructs citing 3+ specific data points and stating a price target
- [ ] Bear prompt instructs quantifying downside in $/% and identifying weakest bull indicator
- [ ] Risk prompt instructs outputting entry price, stop-loss, profit target, risk/reward ratio, position sizing, and IV assessment
- [ ] Existing agent retry and fallback behavior unchanged
- [ ] All related tests pass

## Technical Details

### Files to modify
- `src/option_alpha/ai/agents.py` — update `BULL_SYSTEM_PROMPT`, `BEAR_SYSTEM_PROMPT`, `RISK_SYSTEM_PROMPT`
- `tests/test_ai.py` — verify prompt content

### BULL_SYSTEM_PROMPT update
```
You are a bullish stock analyst. Analyze the provided data and make the strongest
case for this stock. You MUST:
1. Cite at least 3 specific indicator values from the data (e.g., "RSI at 62 shows bullish momentum")
2. Identify the single strongest confirming indicator and explain why
3. State a specific price target with timeframe (e.g., "$185 within 2 weeks based on BB upper band")
4. Reference options data if available (IV level, Greeks supporting the thesis)
Be data-driven — every claim must reference a number from the context.
```

### BEAR_SYSTEM_PROMPT update
```
You are a bearish stock analyst. Counter the bull thesis with specific, data-driven
arguments. You MUST:
1. Quantify the downside risk in both dollar and percentage terms
2. Identify the weakest indicator in the bull case — the most vulnerable data point
3. Cite a specific risk scenario with trigger conditions (e.g., "if RSI drops below 30, expect...")
4. Reference any concerning options signals (high IV = expensive premium, low OI = illiquidity)
Every argument must reference specific numbers from the provided data.
```

### RISK_SYSTEM_PROMPT update
Keep existing conviction rubric and direction signal weighting. Add explicit output requirements:
```
...Your output MUST include these specific fields:
- Entry price: specific price or narrow range
- Stop-loss: ATR-based level (reference ATR% from data)
- Profit target: based on technical levels (BB bands, support/resistance from data)
- Risk/reward ratio: calculated from entry, stop, and target
- Position sizing: conservative suggestion as % of portfolio (1-5%)
- IV assessment: whether current implied volatility supports or undermines the thesis
...
```

### Implementation notes
- Keep prompts concise — avoid bloating system prompt beyond ~300 tokens
- Include 1 short example line to anchor format expectations
- Do NOT change function signatures, retry logic, or response models
- Existing `AgentResponse` and `TradeThesis` models already have all needed fields

## Dependencies
- [ ] Task 003 should be complete (enriched context feeds into these prompts)

## Effort Estimate
- Size: S
- Hours: 1-2
- Parallel: false — depends on Task 003

## Definition of Done
- [ ] All three prompts updated per requirements
- [ ] Prompt strings contain expected keywords verified by tests
- [ ] Existing agent tests pass (retry, fallback behavior unchanged)
- [ ] `pytest tests/test_ai.py` passes
