---
name: Improve candidates table visual hierarchy
status: open
created: 2026-02-14T13:19:45Z
updated: 2026-02-14T13:26:09Z
github: https://github.com/jobu711/option_alpha_v2/issues/98
depends_on: []
parallel: true
conflicts_with: [104]
---

# Task: Improve candidates table visual hierarchy

## Description
Enhance the candidates table to make it easier to visually scan results. Add colored score bars, direction icons with semantic colors, top-5 candidate highlights, a "debated" badge for tickers with debate results, and improved sort indicators.

## Acceptance Criteria
- [ ] Composite score column shows a colored bar/pill alongside the number (red for low, yellow for mid, green for high scores)
- [ ] Direction column shows icon + text: ▲ Bullish (green), ▼ Bearish (red), — Neutral (yellow)
- [ ] Top 5 candidates (by composite score) have a subtle gold left-border highlight
- [ ] Tickers with existing debate results show a small "debated" badge/icon in the row
- [ ] Sort indicators (▲▼) are clearly visible and indicate current sort column and direction
- [ ] All enhancements work within the existing dark theme

## Technical Details

**Files to modify:**
- `src/option_alpha/web/templates/_candidates_table.html`:
  - **Score bar**: Add `<div class="score-bar"><div class="score-bar-fill" style="width: {{ score.composite_score }}%; background: {{ score_color(score.composite_score) }}"></div></div>` next to the score number
  - **Direction icons**: Replace plain text with `<span class="direction direction--{{ score.direction }}">{{ direction_icon(score.direction) }} {{ score.direction | title }}</span>`
  - **Top-N highlight**: Add `{% if loop.index <= 5 %}class="top-candidate"{% endif %}` to `<tr>` (assumes table is sorted by composite score desc)
  - **Debated badge**: Add `{% if score.ticker in debated_tickers %}<span class="debated-badge">debated</span>{% endif %}` in the ticker column
  - **Sort indicators**: Ensure current sort column header has `sort-active` class with directional arrow

- `src/option_alpha/web/routes.py`:
  - In the dashboard/candidates route, query the `ai_theses` table to get a set of tickers that have debate results: `debated_tickers = {row['ticker'] for row in ...}`
  - Pass `debated_tickers` to the template context

- `src/option_alpha/web/static/style.css`:
  - `.score-bar` — 60px wide, 6px height, dark background, border-radius
  - `.score-bar-fill` — height 100%, border-radius, transition
  - Score color helper: 0-33 = red (#ef4444), 34-66 = yellow (#eab308), 67-100 = green (#22c55e)
  - `.direction--bullish` — color: green; `.direction--bearish` — color: red; `.direction--neutral` — color: yellow
  - `.top-candidate` — border-left: 3px solid #d4a017 (gold), slightly lighter background
  - `.debated-badge` — tiny pill, font-size 0.65rem, background #3b82f6, border-radius, padding 1px 6px
  - `.sort-active` — bold text or underline to distinguish from non-sorted columns

**Key considerations:**
- Score color can be computed in Jinja2 with a simple if/elif or via a CSS `hsl()` gradient based on the value
- The `debated_tickers` set query should use the latest scan_run_id to get current debates only
- Top-5 highlight assumes default sort is composite_score desc; if user changes sort, the highlight should still mark the top-5 by score (use a Jinja2 variable, not just loop.index)

## Dependencies
- [ ] None — independent, but shares `_candidates_table.html` with Task 4 (conflicts_with)

## Effort Estimate
- Size: M
- Parallel: true (but coordinate with Task 4 on _candidates_table.html)
