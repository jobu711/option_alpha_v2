---
name: Integrate failure cache into orchestrator
status: closed
created: 2026-02-11T13:44:14Z
updated: 2026-02-11T13:44:14Z
github: https://github.com/jobu711/option_alpha_v2/issues/15
depends_on: [19, 14]
parallel: false
conflicts_with: []
---

# Task: Integrate failure cache into orchestrator

## Description
Modify `_phase_data_fetch` in the pipeline orchestrator to: load the failure cache before fetching, filter out known-failed tickers from `to_fetch`, pass fetch config parameters from Settings to `fetch_batch()`, and record new failures after fetch completes. Log skip counts.

## Acceptance Criteria
- [ ] `_phase_data_fetch` loads failure cache before fetch using configured TTL
- [ ] Known-failed tickers are filtered out of the fetch list
- [ ] Fetch config params (batch_size, max_workers, max_retries, retry_delays) passed from Settings to `fetch_batch()`
- [ ] New failures recorded to cache after fetch completes
- [ ] Skip count logged (e.g., "Skipping 5 tickers from failure cache")
- [ ] All existing tests pass

## Technical Details
- File: `src/option_alpha/pipeline/orchestrator.py`
- Import `load_failure_cache`, `record_failures` from `data.cache`
- Flow: load cache → filter tickers → fetch_batch(config params) → record failures
- Settings fields accessed via `self.settings` or passed config object
- Log at INFO level for skip counts, DEBUG for individual skipped tickers

## Dependencies
- [ ] #19 (failure cache functions must exist)
- [ ] #14 (fetcher must accept configurable params and return classified errors)

## Effort Estimate
- Size: S
- Hours: 1-2
- Parallel: false (depends on both #19 and #14)

## Definition of Done
- [ ] Code implemented
- [ ] Tests written and passing
- [ ] Existing 547+ tests still pass
