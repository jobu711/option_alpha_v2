---
name: Add debate button, results container, and JS wiring to dashboard
status: open
created: 2026-02-14T00:12:02Z
updated: 2026-02-14T00:12:02Z
github: https://github.com/jobu711/option_alpha_v2/issues/92
depends_on: [93, 95]
parallel: false
conflicts_with: [95]
---

# Task: Add debate button, results container, and JS wiring to dashboard

## Description
Add a "Debate Selected" button with count indicator, a results container div, and the minimal JavaScript needed to collect checked symbols and wire up the HTMX POST to `/debate`.

## Acceptance Criteria
- [ ] "Debate Selected (N)" button appears below the candidates table
- [ ] Button is disabled when no checkboxes are checked
- [ ] Button is disabled with tooltip when a scan is running
- [ ] Selected count updates dynamically as checkboxes are toggled
- [ ] Clicking the button triggers `hx-post="/debate"` with `{"symbols": [...]}` JSON body
- [ ] HTMX response renders into `#debate-results` container
- [ ] Loading indicator (hx-indicator) shows while debate request is in flight
- [ ] Button shows "Debating..." state while request is active

## Technical Details
- **File**: `src/option_alpha/web/templates/dashboard.html`
  - Add debate controls section between candidates and detail panel:
    ```html
    <section class="debate-controls">
        <button id="debate-btn" class="btn btn-secondary" disabled
                hx-post="/debate"
                hx-target="#debate-results"
                hx-swap="innerHTML"
                hx-indicator="#debate-spinner">
            Debate Selected (<span id="debate-count">0</span>)
        </button>
        <span id="debate-spinner" class="htmx-indicator">Debating...</span>
    </section>
    <div id="debate-results"></div>
    ```
  - Add inline `<script>` at bottom of content block:
    - Listen for `debate-selection-changed` events from checkboxes
    - Count checked `.debate-check` inputs, update `#debate-count` text
    - Enable/disable `#debate-btn` based on count > 0 and not scan_running
    - Override `hx-vals` on the button: collect all checked symbol values into `{"symbols": [...]}`
    - Use `htmx.on("htmx:configRequest", ...)` to inject JSON body
  - Pass `scan_running` and `debate_running` template variables for initial button state

## Dependencies
- [ ] Issue #2 (POST /debate endpoint must exist)
- [ ] Issue #3 (checkboxes must exist in candidates table)

## Effort Estimate
- Size: M
- Hours: 2-3
- Parallel: false (depends on #2 and #3)

## Definition of Done
- [ ] Button renders with correct disabled/enabled states
- [ ] Count updates on checkbox changes
- [ ] HTMX POST fires with correct JSON body
- [ ] Results render inline without page reload
