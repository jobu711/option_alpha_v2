---
name: Universe data store and baseline generation
status: open
created: 2026-02-11T14:35:48Z
updated: 2026-02-11T14:41:55Z
github: https://github.com/jobu711/option_alpha_v2/issues/21
depends_on: []
parallel: false
conflicts_with: [27]
---

# Task: Universe data store and baseline generation

## Description

Replace the hardcoded `SP500_CORE`, `POPULAR_OPTIONS`, and `OPTIONABLE_ETFS` Python lists in `data/universe.py` with a file-backed JSON data store. Create a `universe_data.json` file containing ~3,000 optionable US tickers with metadata (symbol, name, sector, market-cap tier, asset type). Write a one-time generation script that sources tickers from SEC EDGAR `company_tickers.json`, validates optionability via yfinance, and enriches with sector/market-cap metadata. Refactor `universe.py` to load from the JSON file while maintaining backward-compatible `get_full_universe()` API.

## Acceptance Criteria

- [ ] `universe_data.json` exists in `src/option_alpha/data/` with schema: `[{"symbol": str, "name": str, "sector": str, "market_cap_tier": str, "asset_type": str}, ...]`
- [ ] Baseline contains 2,800-3,500 validated optionable tickers
- [ ] Each ticker has sector (GICS), market_cap_tier (large/mid/small/micro), and asset_type (stock/etf)
- [ ] `market_cap_tier` boundaries: large >$10B, mid $2-10B, small $300M-2B, micro <$300M
- [ ] `get_full_universe()` returns sorted list of all symbols (backward compatible)
- [ ] `load_universe_data()` returns full list of ticker metadata dicts
- [ ] Hardcoded `SP500_CORE`, `POPULAR_OPTIONS`, `OPTIONABLE_ETFS` lists are removed
- [ ] Pydantic model `UniverseTicker` defined for type-safe metadata access
- [ ] One-time generation script at `scripts/generate_universe.py` (not part of runtime)

## Technical Details

**Files to modify:**
- `src/option_alpha/data/universe.py` — Major refactor: remove hardcoded lists, add `load_universe_data()`, keep `get_full_universe()` and `filter_universe()` APIs
- `src/option_alpha/models.py` — Add `UniverseTicker` Pydantic model

**Files to create:**
- `src/option_alpha/data/universe_data.json` — Shipped baseline (~2-3 MB)
- `scripts/generate_universe.py` — One-time script to generate/regenerate baseline

**Generation approach:**
1. Fetch SEC EDGAR `company_tickers.json` (~10,000 US-listed companies)
2. Filter to common stock (exclude preferred, warrants, units)
3. Batch-check optionability via `yf.Ticker(sym).options` (non-empty = optionable)
4. Fetch `yf.Ticker(sym).info` for sector, marketCap, quoteType
5. Classify market-cap tier from marketCap value
6. Identify ETFs via quoteType == "ETF"
7. Write to `universe_data.json`

**`universe.py` new structure:**
```python
_universe_cache: list[dict] | None = None

def load_universe_data() -> list[dict]:
    """Load universe metadata from JSON file."""
    ...

def get_full_universe() -> list[str]:
    """Return all ticker symbols (backward compatible)."""
    return sorted(t["symbol"] for t in load_universe_data())
```

## Dependencies

- [ ] SEC EDGAR API (`https://www.sec.gov/files/company_tickers.json`) — for ticker discovery
- [ ] yfinance — for optionability validation and metadata enrichment
- [ ] No internal task dependencies (this is the foundation task)

## Effort Estimate

- Size: L
- Hours: 12-16
- Parallel: false (foundation — blocks Tasks 2, 3, 4, 5)

## Definition of Done

- [ ] `universe_data.json` ships with 2,800+ tickers and valid metadata
- [ ] `universe.py` loads from file, no hardcoded lists remain
- [ ] `get_full_universe()` returns all tickers as before
- [ ] `load_universe_data()` returns typed metadata
- [ ] Generation script is documented and reproducible
- [ ] Existing `test_universe.py` tests pass (backward compat)
