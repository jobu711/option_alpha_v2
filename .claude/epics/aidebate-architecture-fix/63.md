---
name: Add config settings and model foundations
status: open
created: 2026-02-13T15:16:40Z
updated: 2026-02-13T15:26:14Z
github: https://github.com/jobu711/option_alpha_v2/issues/63
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Add config settings and model foundations

## Description
Add new configuration settings and Pydantic models that all subsequent tasks depend on. This is the foundation task — it touches `config.py` and `models.py` only, adding new fields with sensible defaults so existing `config.json` files continue to work.

## Acceptance Criteria
- [ ] `ai_per_ticker_timeout: int = 60` added to `Settings` in `config.py`
- [ ] `ai_health_check_timeout: int = 15` added to `Settings` in `config.py`
- [ ] `ai_retry_delays` default changed from `[2.0, 4.0, 8.0]` to `[1.0, 2.0, 4.0, 8.0, 16.0]`
- [ ] `ErrorCategory` StrEnum added to `models.py` with values: `NETWORK`, `PARSE`, `VALIDATION`, `TIMEOUT`, `UNKNOWN`
- [ ] `AgentError` Pydantic model added to `models.py` with fields: `category: ErrorCategory`, `message: str`, `agent_role: str`, `attempt: int`
- [ ] `composite_score: float | None = None` optional field added to `DebateResult`
- [ ] `error: AgentError | None = None` optional field added to `DebateResult`
- [ ] Existing tests still pass (`pytest tests/`)

## Technical Details

### config.py (~line 49-56, AI settings block)
```python
ai_per_ticker_timeout: int = 60          # seconds, per-ticker debate timeout
ai_health_check_timeout: int = 15        # seconds, health check timeout
ai_retry_delays: list[float] = [1.0, 2.0, 4.0, 8.0, 16.0]  # 5 retries (was 3)
```

### models.py
```python
from enum import StrEnum

class ErrorCategory(StrEnum):
    NETWORK = "NETWORK"
    PARSE = "PARSE"
    VALIDATION = "VALIDATION"
    TIMEOUT = "TIMEOUT"
    UNKNOWN = "UNKNOWN"

class AgentError(BaseModel):
    category: ErrorCategory
    message: str
    agent_role: str
    attempt: int
```

Add to `DebateResult` (currently at ~line 124):
```python
class DebateResult(BaseModel):
    symbol: str
    bull: AgentResponse
    bear: AgentResponse
    risk: AgentResponse
    final_thesis: TradeThesis
    composite_score: float | None = None  # NEW
    error: AgentError | None = None       # NEW
```

### Key considerations
- All new fields are optional with defaults — backward compatible
- `StrEnum` requires Python 3.11+ (already our minimum)
- `AgentError` uses Pydantic `BaseModel` to match codebase patterns

## Dependencies
- None — this is the foundation task

## Effort Estimate
- Size: S
- Hours: 1-2
- Parallel: false (must complete before tasks 2-5)

## Definition of Done
- [ ] Code implemented
- [ ] All existing tests pass
- [ ] No breaking changes to existing config.json
