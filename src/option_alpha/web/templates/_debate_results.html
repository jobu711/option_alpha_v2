{% from "_empty_state.html" import empty_state %}
{% if results %}
<div class="debate-results-container">
    <h3>Debate Results</h3>
    {% for r in results %}
    {% set is_fallback = r.conviction == 3 and "No trade" in (r.recommendation or "") %}
    <div class="debate-card {% if is_fallback %}debate-fallback{% endif %}">
        <div class="debate-header">
            <span class="debate-ticker mono">{{ r.symbol }}</span>
            <span class="direction-badge direction-{{ r.direction }}">{{ r.direction | upper }}</span>
            <span class="conviction-badge
                {% if r.conviction >= 7 %}conviction-high
                {% elif r.conviction >= 4 %}conviction-mid
                {% else %}conviction-low{% endif %}">
                {{ r.conviction }}/10
            </span>
            {% if is_fallback %}<span class="fallback-label">[FALLBACK]</span>{% endif %}
        </div>
        <div class="debate-body">
            <div class="debate-agent">
                <strong>Bull:</strong> {{ r.bull_thesis }}
            </div>
            <div class="debate-agent">
                <strong>Bear:</strong> {{ r.bear_thesis }}
            </div>
            <div class="debate-agent">
                <strong>Risk:</strong> {{ r.risk_synthesis }}
            </div>
        </div>
        <div class="debate-footer">
            <strong>Action:</strong> {{ r.recommendation }}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
{{ empty_state(title="No debates yet", message="Select tickers from the candidates table using the checkboxes, then click 'Debate Selected' to run AI analysis.") }}
{% endif %}
